<!--It's just a concept, a chat UI design for direct messaging!
Enjoy! :) Don't forget to click the heart if you like it! -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700">

<ng-container *ngIf="curentChatMember && decodeDataCurrentChatMembers">

  <div class="offline" [class.online]="isOnlineChatMember"></div>
  <!-- [class.online]="isOnlineChatMember" -->
  <!-- Menu -->

  <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
    <mat-icon>more_vert</mat-icon>
  </button>
  <mat-menu #menu="matMenu">
    
    <button mat-menu-item [routerLink]="['/', 'profile', curentChatMember.userId]">
      <mat-icon>account_box</mat-icon>
      <span>Go to profile</span>
    </button>
    <button mat-menu-item (click)="clearCurrentChat()">
      <mat-icon>delete</mat-icon>
      <span>Clear chat</span>
    </button>
    <button mat-menu-item (click)="unsubscribeChatNotyfy(); disableNotify =!disableNotify">
      <mat-icon [hidden]="!disableNotify">notifications_onn</mat-icon>
      <mat-icon [hidden]="disableNotify">notifications_off</mat-icon>
      <span>Disable alerts</span>
    </button>
  </mat-menu>


  <div class="chatbox">
    <div class="top-bar">

      <img class="avatar" 
      [src]="
      decodeDataCurrentChatMembers[curentChatMember.userId].photoUrl ?
      decodeDataCurrentChatMembers[curentChatMember.userId].photoUrl: 'assets/empty_user.png'"
      width="32" height="32" 
      />

      <div class="name">{{curentChatMember.fullName}}</div>
      <span class="close-chat" (click)="closeMessageBox()">x</span>

      <div class="icons">
        <i class="fas fa-phone"></i>
        <i class="fas fa-video"></i>
      </div>

      <!-- <div class="menu" mat-button [matMenuTriggerFor]="menu">
        <div class="dots"></div>
        <li mat-menu-item>Item 1</li>
        <li mat-menu-item>Item 2</li>
      </div> -->
    </div>



    <div class="middle">
      <div class="voldemort">
        <!-- Message Item -->
        <app-message-row *ngFor="let messageRowObj of allMessages; 
                first as first; 
                trackBy: trackByMessages" (deleteMessage)="removeMessage($event)" [firstMessage]="first"
          [messageRowObj]="messageRowObj" [currentUserMessage]="messageRowObj.message.sender === currentUserId"
          [decodeDataChatMember]="decodeDataCurrentChatMembers[messageRowObj.message.sender]">
        </app-message-row>
        <!-- Readet -->
        <span *ngIf="!allMessages[allMessages.length-1]?.unread && !isTypingChatMember" class="is-read-message">readet
        </span>


        <!-- Typong <<<<<<< -->
        <div class="spinner" [hidden]="!isTypingChatMember">
          <div class="bounce1"></div>
          <div class="bounce2"></div>
          <div class="bounce3"></div>
        </div>

      <mat-icon *ngIf="currentFullUrl.includes('product')" title="Send current productLink" (click)="sendPatchCurrentProductUrl()">launch</mat-icon>

      </div>
    </div>
  </div>

</ng-container>


<!-- Input @VievChild-->
<div class="bottom-bar">
  <div class="chat">
    <input type="text" (keydown.enter)="sendMessage()" placeholder="Type a message..." #messageInputRef maxlength="50"
      [formControl]="messageInput" autofocus />
    <img class="send-message-btn" title="Send Message" (click)="sendMessage()"
      src="assets/chat/send-message-button64.png" />
  </div>
</div>



<!-- <span *ngIf="!allMessages[allMessages.length-1]?.unread && !isTypingChatMember"
                class="is-read-message">readet</span> -->


<!-- Typing anumation -->

<!-- <p class="chat-feedback" *ngIf="isTypingChatMember">Your partner is typing…</p> -->
<!-- <div class="spinner" [hidden]="!isTypingChatMember">
              <div class="bounce1"></div>
              <div class="bounce2"></div>
              <div class="bounce3"></div>
            </div> -->

<!-- <form method="post">
              <fieldset>
                <input type="text" placeholder="Type your message…" #messageInputRef maxlength="50"
                  (keydown.enter)="sendMessage()" [formControl]="messageInput" autofocus>
              </fieldset>
            </form> -->
<!-- <img class="send-message-btn" title="Send Message" (click)="sendMessage()"
              src="assets/chat/send-message-button64.png">
          </div> <!-- end chat -->
<!-- </div> end live-chat -->