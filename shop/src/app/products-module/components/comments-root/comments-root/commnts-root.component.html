<section class="comments-box" 
    [class.overflow]="dinamicCommentsArray?.length > 1" 
    [hidden]="!dinamicCommentsArray?.length">
    <!-- Spinner -->
    <ng-template #elseTemplate>
        <mat-spinner class="loading"></mat-spinner>
    </ng-template>

    <!-- Select Filter -->
    <section [hidden]="!(dinamicCommentsArray?.length > 1)">
        <mat-form-field class="filter">
            <mat-label>Select filter</mat-label>
            <mat-select [formControl]="selectFilerValue" (ngModelChange)="sort()">
                <mat-option *ngFor="let option of selectOptions" [value]="option.value">
                    {{option.title}}
                </mat-option>
            </mat-select>
        </mat-form-field>
        
        <div class="filter-arrows">
            <span
            class="up"
            title="Descending order" 
            [class.activated-sort-direction]="sortingArrowType"
            (click)="sortingArrowType = true; sort()"
            >&#x25b2;
        </span>
        <span 
            class="down"
            title="Descending order" 
            [class.activated-sort-direction]="!sortingArrowType"
            (click)="sortingArrowType = false; sort()"
            >&#x25bc;</span>
        </div>
    </section>
        
        
        <!-- Comments -->
    <ng-container *ngFor="let singleComment of dinamicCommentsArray; trackBy:trackByComment">
        <!-- If db has user -->
        <!-- ete es fals chi etum ende hamel chi vergrum ng if chi toxum -->
        <app-single-comment  
            *ngIf="decodedZip?.get(singleComment.sender) as decodedFields"
            (likeComment)="toggleLikeComment($event)" 
            (deleteComment)="deleteComment($event)"
            (editComment)="showEditingCommentFields($event)"
            [singleComment]="singleComment" 
            [decodedFields]="decodedFields"
            [currentUser]="currentUser" 
            [senderUid]="singleComment.sender" 
            [currentProductId]="productFields.currentProductRouteId">
        </app-single-comment>

    </ng-container>
</section>


<!-- Add comment -->
<div class="write-comment-fields">
    <mat-form-field appearance="outline">
        <mat-label>Write Comment</mat-label>
        <textarea matInput placeholder="Write Good Comment" [formControl]="commentTexteria">
        </textarea>
        <button [_persistance]="submitButtonCallack" mat-raised-button color="primary">{{submitButtonText}}</button>
        <button *ngIf="isEditing" (click)="cancelCommentEditing()" mat-raised-button >Cancel</button>
        <span>{{this.commentTexteria.value.length}} / 346</span>
    </mat-form-field>
    
</div>